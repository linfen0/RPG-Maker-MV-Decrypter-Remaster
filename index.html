<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>RPG Maker MV/MZ Decrypter</title>

	<!-- Material Symbols -->
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
	<!-- Roboto Font -->
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

	<!-- Styles -->
	<link rel="stylesheet" href="styles/style.css">

	<!-- Material Web Components -->
	<script type="module">
		import '@material/web/all.js';
		import { styles as typescaleStyles } from '@material/web/typography/md-typescale-styles.js';
		document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
	</script>
</head>

<body>
	<div class="app-container">
		<!-- Top App Bar -->
		<header class="top-app-bar">
			<md-icon-button>
				<md-icon>menu</md-icon>
			</md-icon-button>
			<span class="headline-small">RPG Decrypter</span>
			<div class="spacer"></div>
			<md-icon-button id="themeToggle">
				<md-icon>dark_mode</md-icon>
			</md-icon-button>
		</header>

		<!-- Main Content -->
		<main class="main-content">

			<!-- Mode Switcher -->
			<div class="mode-switcher-container">
				<md-tabs id="modeTabs">
					<md-primary-tab id="tab-decrypt" aria-selected="true">
						Decrypt
						<md-icon slot="icon">lock_open</md-icon>
					</md-primary-tab>
					<md-primary-tab id="tab-encrypt">
						Encrypt
						<md-icon slot="icon">lock</md-icon>
					</md-primary-tab>
					<md-primary-tab id="tab-restore">
						Restore
						<md-icon slot="icon">image_search</md-icon>
					</md-primary-tab>
				</md-tabs>
			</div>

			<!-- Action Area -->
			<div class="action-area">

				<!-- Folder Drop Zone -->
				<div id="dropZone" class="drop-zone">
					<md-icon class="drop-icon">folder_open</md-icon>
					<span class="title-large">Drop Folder Here</span>
					<span class="body-medium">or</span>
					<md-filled-button id="selectFolderBtn">
						<md-icon slot="icon">create_new_folder</md-icon>
						Select Folder
					</md-filled-button>
					<div class="secondary-actions">
						<md-text-button id="selectFilesBtn">
							Select Single Files
						</md-text-button>
					</div>
				</div>

				<!-- Settings Card (Context Aware) -->
				<md-elevation></md-elevation>
				<div class="settings-card">
					<div class="settings-header">
						<md-icon>settings</md-icon>
						<span class="title-medium">Settings</span>
					</div>

					<div class="settings-content">
						<!-- Decrypt/Encrypt Key -->
						<md-outlined-text-field id="decryptCode" label="Decryption Key" type="text"
							class="full-width hidden">
							<md-icon-button slot="trailing-icon" id="detectKeyBtn" title="Detect from System.json">
								<md-icon>search</md-icon>
							</md-icon-button>
						</md-outlined-text-field>

						<!-- Encrypt Target Version -->
						<div id="encryptOptions" class="radio-group hidden">
							<span class="label-large">Target Version:</span>
							<label class="radio-label">
								<md-radio name="targetVer" value="mv" checked></md-radio>
								MV
							</label>
							<label class="radio-label">
								<md-radio name="targetVer" value="mz"></md-radio>
								MZ
							</label>
						</div>

						<!-- Header Options -->
						<div class="header-options">
							<label class="checkbox-label">
								<md-checkbox id="verifyHeader" checked></md-checkbox>
								Verify/Add Fake Header
							</label>
						</div>
					</div>
				</div>
			</div>

			<!-- Progress & Actions -->
			<div class="process-area">
				<div class="info-row">
					<span class="body-large" id="statusText">Ready</span>
					<span class="body-large" id="fileCount">0 files</span>
				</div>
				<md-linear-progress id="progressBar" value="0"></md-linear-progress>

				<div class="fab-container">
					<md-fab id="startBatchBtn" variant="primary" label="Start">
						<md-icon slot="icon">play_arrow</md-icon>
					</md-fab>
				</div>
			</div>

			<!-- Results Area -->
			<div class="results-area">
				<details class="log-details">
					<summary>
						<span class="label-large">Process Log</span>
						<md-icon>expand_more</md-icon>
					</summary>
					<div class="log-content">
						<pre id="batchLog">Waiting for action...</pre>
					</div>
				</details>

				<div class="preview-grid" id="previewGrid">
					<!-- Preview Cards will be injected here -->
				</div>
			</div>

		</main>
	</div>

	<!-- Hidden Inputs -->
	<input type="file" id="folderInput" webkitdirectory directory multiple style="display: none;">
	<input type="file" id="fileInput" multiple style="display: none;">
	<input type="file" id="systemFileDetect" accept=".json,.rpgmvp,.png_" style="display: none;">

	<!-- Scripts -->
	<script src="libs/FileSaver.min.js"></script>
	<script src="libs/jszip.min.js"></script>
	<script src="libs/lz-string.min.js"></script>
	<script src="scripts/RPGFile.js"></script>
	<script src="scripts/ErrorException.js"></script>
	<script src="scripts/Decrypter.js"></script>
	<script src="scripts/ZIP.js"></script>
	<!-- <script src="scripts/functions.js"></script> -->
	<!-- Legacy functions might not be needed or need refactoring -->
	<script src="scripts/batch.js"></script>
</body>

</html>